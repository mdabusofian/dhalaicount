<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶¢‡¶æ‡¶≤‡¶æ‡¶á ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞ V4 - ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤</title>
    <style>
        /* Base Styling - LIGHT MODE (Default) */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f4f7; /* Light Blue Background */
            color: #333;
            transition: background-color 0.3s, color 0.3s; /* Smooth transition for mode switch */
        }
        .container {
            max-width: 650px;
            margin: 0 auto;
            background: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        h2 {
            color: #0d47a1;
            border-bottom: 3px solid #bbdefb;
        }

        /* Mode Switch Button */
        #modeToggle {
            background-color: #607d8b; /* Blue Grey */
            color: white;
            width: auto;
            padding: 8px 15px;
            margin-bottom: 15px;
            display: block; /* Make it block level to occupy full width */
            margin-left: auto; /* Push to right/center */
            margin-right: auto;
        }

        /* Section Styling */
        .session-info {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
        }
        .controls {
            background-color: #fcfcfc;
            border: 1px solid #e0e0e0;
        }
        .summary {
            background-color: #fff8e1;
            border: 1px solid #ffe082;
        }
        .counter-display {
            background-color: #eceff1;
        }
        .counter-item span {
            color: #0d47a1;
        }

        /* Dark Mode Specific Styles */
        [data-theme='dark'] body {
            background-color: #121212;
            color: #f0f0f0;
        }
        [data-theme='dark'] .container {
            background: #1e1e1e;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        [data-theme='dark'] h2 {
            color: #90caf9; /* Light Blue */
            border-bottom-color: #424242;
        }
        [data-theme='dark'] #modeToggle {
            background-color: #424242;
        }

        [data-theme='dark'] .session-info {
            background-color: #2c2c2c;
            border: 1px solid #424242;
        }
        [data-theme='dark'] .session-info label,
        [data-theme='dark'] .session-info input {
            color: #f0f0f0;
            background-color: #333;
            border-color: #666;
        }
        [data-theme='dark'] .controls {
            background-color: #242424;
            border: 1px solid #333;
        }
        [data-theme='dark'] .summary {
            background-color: #33332e;
            border: 1px solid #4a4a3e;
        }
        [data-theme='dark'] .counter-display {
            background-color: #333;
        }
        [data-theme='dark'] .counter-item span {
            color: #e0f2f1; /* Light Teal */
        }
        
        [data-theme='dark'] .status-board {
            /* Adjust status board background for better contrast in dark mode */
            background-color: #424242 !important;
            color: #f0f0f0 !important;
        }
        /* Common styles (retained from V3) */
        /* ... (rest of the V3 styles can be here, they generally apply to both, but dark mode overrides specific colors) */

        .session-info { padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .session-info input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; box-sizing: border-box; }
        .session-info label { font-weight: bold; display: block; margin-top: 10px; }
        #startProject { background-color: #4CAF50; color: white; margin-top: 15px; }
        .controls, .summary, .submit-section { margin-bottom: 25px; padding: 20px; border-radius: 8px; }
        button { padding: 12px; margin: 8px 0; font-size: 18px; cursor: pointer; border: none; border-radius: 6px; transition: background-color 0.3s, opacity 0.3s; width: 100%; font-weight: bold; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        #addSand { background-color: #64b5f6; color: white; }
        #addConcrete { background-color: #26a69a; color: white; }
        #nextBatch { background-color: #ffb74d; color: #333; }
        #finalSubmit { background-color: #e53935; color: white; margin-top: 20px; }
        .counter-display { display: flex; justify-content: space-around; text-align: center; margin: 15px 0; padding: 10px; border-radius: 6px; }
        .counter-item { font-size: 24px; font-weight: bold; flex-grow: 1; }
        .status-board { padding: 15px; margin: 10px 0; border-radius: 6px; font-weight: bold; text-align: center; min-height: 40px; }
        .summary p { font-size: 16px; margin: 8px 0; padding-left: 10px; border-left: 4px solid #f9a825; }
        .summary strong { font-size: 18px; color: #d84315; }
    </style>
</head>
<body data-theme="light">

<div class="container">
    <button id="modeToggle">üåô ‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <h2>üèóÔ∏è ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶¢‡¶æ‡¶≤‡¶æ‡¶á ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞</h2>
    <p style="text-align: center;">‡¶Æ‡¶ø‡¶ï‡ßç‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶™‡¶æ‡¶§: **‡ßß ‡¶¨‡¶∏‡ßç‡¶§‡¶æ ‡¶∏‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü : ‡ß© ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶¨‡¶æ‡¶≤‡¶ø : ‡ß´ ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü**</p>

    <div class="session-info" id="sessionSetup">
        <h3>‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø (‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®)</h3>
        <label for="projectName">‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü/‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</label>
        <input type="text" id="projectName" value="‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶æ‡¶¶ ‡¶¢‡¶æ‡¶≤‡¶æ‡¶á" required>
        
        <label for="projectDate">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
        <input type="date" id="projectDate" required>
        
        <button id="startProject">‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div id="mainTracker" style="display: none;">
        <div class="controls">
            <h3>‡ßß. ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö (<span id="cementCountDisplay">‡ßß</span> ‡¶®‡¶Ç ‡¶¨‡¶∏‡ßç‡¶§‡¶æ)</h3>
            
            <div class="counter-display">
                <div class="counter-item">
                    ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶¨‡¶æ‡¶≤‡¶ø: <span id="sandCounter">3</span>
                </div>
                <div class="counter-item">
                    ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü: <span id="concreteCounter">5</span>
                </div>
            </div>

            <button id="addSand">‡ßß ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶¨‡¶æ‡¶≤‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button id="addConcrete">‡ßß ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            
            <div id="batchStatus" class="status-board" style="background-color: #fff9c4; color: #f9a825;">‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>
            
            <button id="nextBatch" disabled>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶∏‡ßç‡¶§‡¶æ (‡¶∏‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá)</button>
        </div>

        <div class="summary">
            <h3>‡ß®. ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶¨‡¶ß‡¶ø ‡¶Æ‡ßã‡¶ü ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h3>
            <p>‡¶Æ‡ßã‡¶ü ‡¶∏‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü: <strong id="totalCement">0</strong> ‡¶¨‡¶∏‡ßç‡¶§‡¶æ</p>
            <p>‡¶Æ‡ßã‡¶ü ‡¶¨‡¶æ‡¶≤‡¶ø: <strong id="totalSand">0</strong> ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø</p>
            <p>‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü: <strong id="totalConcrete">0</strong> ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø</p>
        </div>

        <div class="submit-section">
            <h3>‡ß©. ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶°</h3>
            <button id="finalSubmit">‡¶Æ‡ßã‡¶ü ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßá‡¶∑ ‡¶ì ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ Google Sheet-‡¶è ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</button>
            <div id="submitMessage" class="status-board" style="background-color: #fbebeb; color: #e53935;">‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡•§</div>
        </div>
    </div>
</div>

<script>
    // ====================================================================================
    // !!! ‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£: ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶∞‡ßç‡¶Æ ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® !!!
    // ====================================================================================
    const GOOGLE_FORM_URL = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞_‡¶´‡¶∞‡ßç‡¶Æ_‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏_URL_‡¶è‡¶ñ‡¶æ‡¶®‡ßá_‡¶¶‡¶ø‡¶®'; 
    const ENTRY_ID_PROJECT = 'entry.PPPPPPPPP';
    const ENTRY_ID_DATE = 'entry.DDDDDDDDD';
    const ENTRY_ID_CEMENT = 'entry.XXXXXXXXX';
    const ENTRY_ID_SAND = 'entry.YYYYYYYYY';
    const ENTRY_ID_CONCRETE = 'entry.ZZZZZZZZZ';
    // ====================================================================================

    const SAND_PER_BATCH = 3;
    const CONCRETE_PER_BATCH = 5;

    let currentSand = 0;
    let currentConcrete = 0;
    let totalCement = 0;
    let totalSand = 0;
    let totalConcrete = 0;
    
    let projectDetails = { name: '', date: '' };


    // --- DOM ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ---
    const body = document.body;
    const modeToggle = document.getElementById('modeToggle');
    const mainTracker = document.getElementById('mainTracker');
    const sessionSetup = document.getElementById('sessionSetup');
    const startProjectButton = document.getElementById('startProject');
    const projectNameInput = document.getElementById('projectName');
    const projectDateInput = document.getElementById('projectDate');
    const sandCounter = document.getElementById('sandCounter');
    const concreteCounter = document.getElementById('concreteCounter');
    const totalCementDisplay = document.getElementById('totalCement');
    const totalSandDisplay = document.getElementById('totalSand');
    const totalConcreteDisplay = document.getElementById('totalConcrete');
    const cementCountDisplay = document.getElementById('cementCountDisplay');
    const nextBatchButton = document.getElementById('nextBatch');
    const finalSubmitButton = document.getElementById('finalSubmit');
    const batchStatus = document.getElementById('batchStatus');
    const submitMessage = document.getElementById('submitMessage');
    const addSandButton = document.getElementById('addSand');
    const addConcreteButton = document.getElementById('addConcrete');
    
    // --- ‡¶≤‡¶æ‡¶á‡¶ü/‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
    function setDarkMode(isDark) {
        if (isDark) {
            body.setAttribute('data-theme', 'dark');
            modeToggle.textContent = '‚òÄÔ∏è ‡¶≤‡¶æ‡¶á‡¶ü ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®';
            localStorage.setItem('theme', 'dark');
        } else {
            body.setAttribute('data-theme', 'light');
            modeToggle.textContent = 'üåô ‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®';
            localStorage.setItem('theme', 'light');
        }
    }

    modeToggle.addEventListener('click', () => {
        const currentTheme = body.getAttribute('data-theme');
        setDarkMode(currentTheme === 'light');
    });

    // --- ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
    startProjectButton.addEventListener('click', () => {
        if (projectNameInput.value && projectDateInput.value) {
            projectDetails.name = projectNameInput.value;
            projectDetails.date = projectDateInput.value;
            sessionSetup.style.display = 'none';
            mainTracker.style.display = 'block';
            alert(`‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ! ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü: ${projectDetails.name}, ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${projectDetails.date}`);
            updateDisplay();
        } else {
            alert("‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
        }
    });

    // --- ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
    function updateDisplay() {
        sandCounter.textContent = SAND_PER_BATCH - currentSand;
        concreteCounter.textContent = CONCRETE_PER_BATCH - currentConcrete;
        
        cementCountDisplay.textContent = totalCement + 1;
        totalCementDisplay.textContent = totalCement;
        totalSandDisplay.textContent = totalSand;
        totalConcreteDisplay.textContent = totalConcrete;

        const isSandComplete = currentSand >= SAND_PER_BATCH;
        const isConcreteComplete = currentConcrete >= CONCRETE_PER_BATCH;

        addSandButton.disabled = isSandComplete;
        addConcreteButton.disabled = isConcreteComplete;
        
        if (isSandComplete && isConcreteComplete) {
            nextBatchButton.disabled = false;
            nextBatchButton.style.backgroundColor = '#4CAF50';
            nextBatchButton.textContent = `‚úÖ ${totalCement + 1} ‡¶®‡¶Ç ‡¶¨‡¶∏‡ßç‡¶§‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®‡•§ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶∏‡ßç‡¶§‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`;
            batchStatus.style.backgroundColor = '#c8e6c9'; /* Light Green */
            batchStatus.style.color = '#1b5e20';
            batchStatus.textContent = "‚úÖ ‡¶è‡¶á ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡•§";
        } else {
            nextBatchButton.disabled = true;
            nextBatchButton.style.backgroundColor = '#ffb74d';
            nextBatchButton.textContent = `‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶∏‡ßç‡¶§‡¶æ (‡¶∏‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá)`;
            
            let missing = [];
            if (!isSandComplete) {
                missing.push(`‡¶¨‡¶æ‡¶≤‡¶ø (${SAND_PER_BATCH - currentSand})`);
            }
            if (!isConcreteComplete) {
                missing.push(`‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü (${CONCRETE_PER_BATCH - currentConcrete})`);
            }

            if (missing.length > 0) {
                 batchStatus.style.backgroundColor = '#fff9c4'; /* Light Yellow */
                 batchStatus.style.color = '#f9a825';
                 batchStatus.textContent = `‚ö†Ô∏è ‡¶Ü‡¶∞‡¶ì ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá: ${missing.join(' ‡¶è‡¶¨‡¶Ç ')} ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø‡•§`;
            } else {
                 batchStatus.textContent = "‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
            }
        }
    }

    // --- ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á) ---
    function submitToGoogleForm() {
        if (!projectDetails.name || !projectDetails.date) {
            alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá!");
            return;
        }

        submitMessage.style.backgroundColor = '#e3f2fd';
        submitMessage.style.color = '#1565c0';
        submitMessage.textContent = "üîÑ ‡¶°‡ßá‡¶ü‡¶æ Google Sheet-‡¶è ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...";
        finalSubmitButton.disabled = true;

        const data = {
            [ENTRY_ID_PROJECT]: projectDetails.name,
            [ENTRY_ID_DATE]: projectDetails.date,
            [ENTRY_ID_CEMENT]: totalCement,
            [ENTRY_ID_SAND]: totalSand,
            [ENTRY_ID_CONCRETE]: totalConcrete,
        };

        const formBody = Object.keys(data).map(key => {
            return encodeURIComponent(key) + '=' + encodeURIComponent(data[key]);
        }).join('&');

        fetch(GOOGLE_FORM_URL, {
            method: 'POST',
            body: formBody,
            mode: 'no-cors' 
        })
        .then(() => {
            submitMessage.style.backgroundColor = '#e8f5e9';
            submitMessage.style.color = '#1b5e20';
            submitMessage.textContent = `‚úÖ ‡¶∏‡¶´‡¶≤! ‡¶Æ‡ßã‡¶ü ${totalCement} ‡¶¨‡¶∏‡ßç‡¶§‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ Google Sheet-‡¶è ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`;
            
            setTimeout(() => {
                const confirmReset = confirm("‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?");
                if (confirmReset) {
                    resetTracker();
                    alert("‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
                } else {
                    finalSubmitButton.disabled = false;
                }
            }, 1000);
        })
        .catch(error => {
            submitMessage.style.backgroundColor = '#ffebee';
            submitMessage.style.color = '#c62828';
            submitMessage.textContent = '‚ùå ‡¶°‡ßá‡¶ü‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§';
            finalSubmitButton.disabled = false;
            console.error('Google Form-‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá:', error);
        });
    }

    // --- ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
    function resetTracker() {
        currentSand = 0;
        currentConcrete = 0;
        totalCement = 0;
        totalSand = 0;
        totalConcrete = 0;
        finalSubmitButton.disabled = false;
        submitMessage.style.backgroundColor = '#fbebeb';
        submitMessage.style.color = '#e53935';
        submitMessage.textContent = "‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡•§";
        
        sessionSetup.style.display = 'block';
        mainTracker.style.display = 'none';
        projectNameInput.value = "‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶æ‡¶¶ ‡¶¢‡¶æ‡¶≤‡¶æ‡¶á";
        projectDateInput.valueAsDate = new Date();
        projectDetails = { name: '', date: '' };
        
        updateDisplay();
    }


    // --- ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ ---
    addSandButton.addEventListener('click', () => {
        if (currentSand < SAND_PER_BATCH) {
            currentSand++;
            totalSand++;
            updateDisplay();
        } else {
            alert('‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ: ‡ß© ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶¨‡¶æ‡¶≤‡¶ø ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá!');
        }
    });

    addConcreteButton.addEventListener('click', () => {
        if (currentConcrete < CONCRETE_PER_BATCH) {
            currentConcrete++;
            totalConcrete++;
            updateDisplay();
        } else {
             alert('‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ: ‡ß´ ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶ï‡ßç‡¶∞‡¶Ç‡¶ï‡¶ø‡¶ü ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá!');
        }
    });

    nextBatchButton.addEventListener('click', () => {
        if (currentSand >= SAND_PER_BATCH && currentConcrete >= CONCRETE_PER_BATCH) {
            totalCement++; 
            currentSand = 0;
            currentConcrete = 0;
            alert(`‚úÖ ${totalCement} ‡¶®‡¶Ç ‡¶¨‡¶∏‡ßç‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®‡•§`);
            updateDisplay();
        }
    });

    finalSubmitButton.addEventListener('click', () => {
        const confirmMsg = `‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü: ${projectDetails.name}-‡¶è‡¶∞ ‡¶Æ‡ßã‡¶ü ${totalCement} ‡¶¨‡¶∏‡ßç‡¶§‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§‡¶≠‡¶æ‡¶¨‡ßá Google Sheet-‡¶è ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ö‡¶≤‡ßá‡¶õ‡ßá‡¶®‡•§ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`;
        if (confirm(confirmMsg)) {
            submitToGoogleForm();
        }
    });
    
    // --- ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®: ‡¶•‡¶ø‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ---
    window.onload = () => {
        // ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶•‡¶ø‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setDarkMode(savedTheme === 'dark');
        } else {
            // ‡¶Ø‡¶¶‡¶ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶™‡ßç‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                 setDarkMode(true);
            } else {
                 setDarkMode(false);
            }
        }

        // ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
        projectDateInput.valueAsDate = new Date();
        updateDisplay();
    };
</script>

</body>
</html>
